{% extends "base.html" %}
{% load blog_tags %}
{% load mptt_tags %}
 
{% block title %}My Blog{% endblock %}
 
{% block content %}
<div class="container-fluid mt-5 pt-5">

  <h1>My Blog</h1>
  <div class="row">
        <div class="col-sm-2">
            <h3>Категорії</h3>
            <ul>
                <li>
                    <a href="{% url 'blog:post_list' %}">Всі категорії ({{ count }})</a>
                </li>
            </ul>
            <ul>
                {% recursetree categories %}
                {% if node.items_count %}
                <li> <a href="{{ node.get_absolute_url }} ">{{ node.name }}
                    <span>({{ node.items_count }})</span></a>
                    {% if not node.is_leaf_node %}
                    <ul>
                        <a href="{{ children.det_absolute_url }}"> {{ children }}</a>
                    </ul>
                    {% endif %}
                </li>
                {% endif %}
                {% endrecursetree %}
            </ul>
        </div>
        <div class="col-sm-8">
          <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    {% for crumb in breadcrumb %}
                    <li class="breadcrumb-item"> <a href="{{ crumb.get_absolute_url }}"> {{ crumb }} </a> </li>
                    {% endfor %}
                </ol>
            </nav>
  {% if tag %}
    <h4>Posts tagged with "{{ tag.name }}"</h4>
  {% endif %}
  {% for post in posts %}
    <h2>
      <a href="{{ post.get_absolute_url }}">
        {{ post.title }}
      </a>
    </h2>
    <p class="tags">
      Tags:
      {% for tag in post.tags.all %}
        <a href="{% url 'blog:post_list_by_tag' tag.slug %}">
          {{ tag.name }}
        </a>
        {% if not forloop.last %}, {% endif %}
      {% endfor %}
    </p>
    <p class="date">
      Published {{ post.publish }} by {{ post.author }}
    </p>
    {{ post.body|markdown|truncatewords_html:30 }}
  {% endfor %}
  {% include "pagination.html" with page=posts %}
</div>
  </div>
</div>
{% endblock %}